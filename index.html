<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Auto Study Tool Pro</title>

<meta name="theme-color" content="#0b1220">

<style>
:root{
  --bg:#050b1a;
  --card:#0b1220;
  --accent:#c7a14a;
  --border:#1e293b;
  --text:#e5e7eb;
  --muted:#94a3b8;
  --green:#22c55e;
  --red:#ef4444;
}

body{
  margin:0;
  font-family: "Segoe UI", system-ui;
  background:linear-gradient(180deg,#020617,#050b1a);
  color:var(--text);
}

.header{
  padding:16px;
  text-align:center;
  font-size:20px;
  font-weight:800;
  background:linear-gradient(135deg,#020617,#0b1220);
  border-bottom:1px solid var(--border);
}

.container{ padding:12px; }

.card{
  background:var(--card);
  border-radius:16px;
  padding:14px;
  margin-bottom:12px;
  box-shadow:0 10px 30px rgba(0,0,0,.3);
}

.card-title{
  font-weight:800;
  color:var(--accent);
  margin-bottom:8px;
  letter-spacing:.5px;
}

/* Pomodoro */
.timer{
  font-size:42px;
  font-weight:900;
  text-align:center;
  margin:10px 0;
}

.timer-mode{
  text-align:center;
  color:var(--muted);
  margin-bottom:10px;
}

.timer-btns{
  display:flex;
  gap:8px;
}

.timer-btns button{
  flex:1;
  padding:10px;
  border-radius:12px;
  border:1px solid var(--border);
  background:#020617;
  color:var(--text);
  font-weight:700;
}

/* Todo */
.todo-input{
  display:flex;
  gap:6px;
  margin-bottom:8px;
}

.todo-input input{
  flex:1;
  padding:8px;
  border-radius:10px;
  border:1px solid var(--border);
  background:#020617;
  color:var(--text);
}

.todo-input button{
  padding:8px 12px;
  border-radius:10px;
  border:none;
  background:var(--accent);
  color:#020617;
  font-weight:800;
}

.todo-item{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:6px 0;
  border-bottom:1px dashed var(--border);
  font-size:14px;
}

.todo-item span.done{
  text-decoration:line-through;
  color:var(--muted);
}

/* Stats */
.stats{
  display:flex;
  justify-content:space-between;
  font-size:13px;
  color:var(--muted);
}
.link-item{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:6px 0;
  border-bottom:1px dashed var(--border);
  font-size:13px;
}

.link-item a{
  color:var(--accent);
  text-decoration:none;
  max-width:70%;
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap;
}
</style>
<script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
</head>
<body>

<div class="header">Auto Study Tool Pro</div>
<div class="container">
<!-- Study Links -->
<div class="card">
  <div class="card-title">Study Links</div>
  <div class="todo-input">
    <input id="linkName" placeholder="Tên link (VD: Toán thầy A)">
    <input id="linkUrl" placeholder="https://...">
    <button onclick="addLink()">+</button>
  </div>
  <div id="linkList"></div>
</div>
<!-- OCR -->
<div class="card">
  <div class="card-title">OCR - Copy đề từ ảnh</div>
  <input type="file" accept="image/*" onchange="runOCR(event)">
  <textarea id="ocrResult" placeholder="Text từ ảnh sẽ hiện ở đây..."
    style="width:100%;height:120px;margin-top:8px;
    background:#020617;color:#e5e7eb;
    border:1px solid #1e293b;border-radius:10px;padding:8px;"></textarea>
</div>
<!-- Pomodoro -->
<div class="card">
  <div class="card-title">Pomodoro Timer</div>
  <div class="timer" id="timer">25:00</div>
  <div class="timer-mode" id="mode">Study</div>
  <div class="timer-btns">
    <button onclick="startTimer()">Start</button>
    <button onclick="pauseTimer()">Pause</button>
    <button onclick="resetTimer()">Reset</button>
  </div>
</div>

<!-- Todo -->
<div class="card">
  <div class="card-title">To-do học tập</div>
  <div class="todo-input">
    <input id="todoText" placeholder="VD: Làm bài Toán chương 3">
    <button onclick="addTodo()">+</button>
  </div>
  <div id="todoList"></div>
</div>

<!-- Stats -->
<div class="card">
  <div class="card-title">Thống kê hôm nay</div>
  <div class="stats">
    <div>Tổng phút học:</div>
    <div id="totalMinutes">0 phút</div>
  </div>
</div>

</div>

<script>
let studySeconds = 25*60;
let breakSeconds = 5*60;
let seconds = studySeconds;
let isStudy = true;
let interval = null;

let totalStudy = parseInt(localStorage.getItem('totalStudy')||'0');

const timerEl = document.getElementById('timer');
const modeEl = document.getElementById('mode');
const totalEl = document.getElementById('totalMinutes');

function updateTimer(){
  const m = Math.floor(seconds/60).toString().padStart(2,'0');
  const s = (seconds%60).toString().padStart(2,'0');
  timerEl.textContent = `${m}:${s}`;
}

function startTimer(){
  if(interval) return;
  interval = setInterval(()=>{
    seconds--;
    if(isStudy){
      totalStudy++;
      localStorage.setItem('totalStudy', totalStudy);
      totalEl.textContent = Math.floor(totalStudy/60) + ' phút';
    }
    if(seconds<=0){
      isStudy = !isStudy;
      modeEl.textContent = isStudy ? 'Study' : 'Break';
      seconds = isStudy ? studySeconds : breakSeconds;
      alert(isStudy ? 'Học tiếp!' : 'Nghỉ giải lao!');
    }
    updateTimer();
  },1000);
}

function pauseTimer(){
  clearInterval(interval);
  interval = null;
}

function resetTimer(){
  pauseTimer();
  isStudy = true;
  modeEl.textContent = 'Study';
  seconds = studySeconds;
  updateTimer();
}

/* Todo */
let todos = JSON.parse(localStorage.getItem('todos')||'[]');
const todoList = document.getElementById('todoList');

function renderTodos(){
  todoList.innerHTML='';
  todos.forEach((t,i)=>{
    const div = document.createElement('div');
    div.className='todo-item';
    div.innerHTML = `
      <span class="${t.done?'done':''}" onclick="toggleTodo(${i})">${t.text}</span>
      <button onclick="deleteTodo(${i})">❌</button>
    `;
    todoList.appendChild(div);
  });
  localStorage.setItem('todos', JSON.stringify(todos));
}

function addTodo(){
  const text = document.getElementById('todoText').value.trim();
  if(!text) return;
  todos.push({text, done:false});
  document.getElementById('todoText').value='';
  renderTodos();
}

function toggleTodo(i){
  todos[i].done = !todos[i].done;
  renderTodos();
}

function deleteTodo(i){
  todos.splice(i,1);
  renderTodos();
}

/* Init */
updateTimer();
renderTodos();
totalEl.textContent = Math.floor(totalStudy/60) + ' phút';
/* Study Links */
let links = JSON.parse(localStorage.getItem('studyLinks')||'[]');
const linkList = document.getElementById('linkList');

function renderLinks(){
  linkList.innerHTML='';
  links.forEach((l,i)=>{
    const div = document.createElement('div');
    div.className='link-item';
    div.innerHTML = `
      <a href="${l.url}" target="_blank">${l.name}</a>
      <button onclick="deleteLink(${i})">❌</button>
    `;
    linkList.appendChild(div);
  });
  localStorage.setItem('studyLinks', JSON.stringify(links));
}

function addLink(){
  const name = document.getElementById('linkName').value.trim();
  const url = document.getElementById('linkUrl').value.trim();
  if(!name || !url) return;
  links.push({name, url});
  document.getElementById('linkName').value='';
  document.getElementById('linkUrl').value='';
  renderLinks();
}

function deleteLink(i){
  links.splice(i,1);
  renderLinks();
}

renderLinks();

/* OCR */
function runOCR(e){
  const file = e.target.files[0];
  if(!file) return;
  const result = document.getElementById('ocrResult');
  result.value = 'Đang nhận dạng chữ...';

  Tesseract.recognize(file, 'eng+vie')
    .then(({ data: { text } }) => {
      result.value = text;
    })
    .catch(err=>{
      result.value = 'Lỗi OCR: ' + err.message;
    });
}
</script>

</body>
</html>
